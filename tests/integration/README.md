# Integration Testing Suite

This directory contains the infrastructure for **Automated Lifecycle Verification** of the Agentic Cortex system.

## üèóÔ∏è Architecture: The "Heartbeat" Loop

The integration tests follow a **Scenario-based Heartbeat** model. Unlike unit tests, these verify the Agent's ability to navigate the full S1-S4 development lifecycle autonomously.

### Core Components
- **`workflow-controller` (Skill)**: The "Watcher" that monitors progress every minute.
- **`heartbeat.py` (Engine)**: Polling script that checks for state flags and updates pointers.
- **`scenarios/` (Data)**: Project-specific prompt fragments and next-step pointers.
- **`LIFECYCLE_VERIFIER.py` (Auditor)**: A black-box forensic tool that verifies protocol compliance (Git, Sync, Success).

## üöÄ Running a Test

To verify the system, follow the instructions in the **[SMOKE_TEST_PROMPT.md](SMOKE_TEST_PROMPT.md)**.

### Standard Workflow
1.  **Preparation**: Ensure the repository is clean.
2.  **Activation**: Tell the Agent: `Hi Cortex, activate the workflow-controller for the web-calculator scenario`.
3.  **Monitoring**: The Agent will run `heartbeat.py --watch` and present fragments from `scenarios/[NAME]/fragments/`.
4.  **Audit**: Once complete, run `python3 tests/integration/LIFECYCLE_VERIFIER.py`.

## üìÇ Scenario Structure
Each scenario in `scenarios/` must follow this layout:
```text
scenarios/
‚îî‚îÄ‚îÄ [scenario-name]/
    ‚îú‚îÄ‚îÄ fragments/          # Ordered .md files (01_..., 02_...)
    ‚îî‚îÄ‚îÄ next-prompt.md      # Auto-generated by heartbeat.py
```

## ‚öñÔ∏è Verification Criteria
The **Black-Box Auditor** uses the following metrics:
- **Git Compliance**: Proper branch naming (`feat/TICKET_*`) and semantic commits.
- **Information Sync**: Consistent Ticket IDs across Specs, Tickets, and Review Reports.
- **Output Integrity**: Artifacts are stored in `tests/integration/outputs/` (Isolated Sandbox).
- **Flag Accuracy**: Sequential presence of `S1_DONE`, `S2_DONE`, etc. in `.agent/workstreams/flags/`.
